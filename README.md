# task1
A task for '"robot system 2020".

### 引用
myled.cは2020年度ロボットシステム学の講義で上田先生が作成したコードを改変したものです。<br>
myled.cの168, 169, 170行目のコードはRT Corporation様のRaspberry Pi Mouse devide driver</br>
(https://github.com/rt-net/RaspberryPiMouse/blob/master/src/drivers/rtmouse.c) の585, 587行目からお借りしました。</br>

### task1概要
Raspberry Pi 4につないだスイッチで10進数の数値を入力すると</br>
2進数に変換して7セグメントLEDに表示するプログラムと、LED制御とスイッチの状態を読み取るデバイスドライバです。</br>

Raspberry Piにつながっている電気部品はLED、タクトスイッチです。外観をpic1に示します。</br>
２つ並んだLEDの左側がLED1、右側がLED2で、３つ並んだタクトスイッチは左側からSW1,SW2,SW3です。</br>

#### myled.c
デバイスドライバのソースファイルです。</br>
機能：</br>
1. スイッチの状態を送信</br>
  1.関数sushi_read()内の168～170行目で３つのスイッチの状態(押されている：0, 押されていない：1)を確認する</br>
  2.それぞれのスイッチの状態に応じた文字を指定する。SW1が押されているときは'1'、SW2なら'2'、SW3なら'3'の文字をsendに代入する。</br>
  3.177行目で送信文字を用意して179行目のcopy_to_user()でデバイスファイルに文字列を書き込む。</br>

2. LEDを制御</br>
  1.デバイスファイルに書き込みがあったときに関数led_write()が呼び出される。</br>
  2.124行目のcopy_form_user()で1文字読み込んでcに代入する。</br>
  3.文字が0～9のときは7セグメントLEDをその数字の通りに点灯させ、'.'のときは7セグの'.'を点灯、'-'なら7セグを消灯させる。7セグメントLEDは64行目の関数seg()で行う。</br>
  4.LED1は'a'で点灯、'b'で消灯して、LED2は'c'で点灯、'd'で消灯する。</br>

3. そのほかの関数</br>
  1.setPin()...199行目、GPOIピンの入出力を設定する。</br>
  2.output()... 52行目、出力に設定されたGPIOピンの電圧ON/OFFを切り替え。</br>


#### Main.c
スイッチからの入力を二進数に変換して表示するプログラムです。</br>
デバイスファイルmyled0からスイッチの状態を得て、LED制御のための文字を送ります。</br>
処理の流れ：</br>

